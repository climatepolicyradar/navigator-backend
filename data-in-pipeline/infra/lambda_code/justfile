# Build Lambda package with dependencies using Docker

build: clean
    set -e
    mkdir -p .lambda_build
    echo "ğŸ³ Building Lambda package with Docker..."
    docker build --platform linux/amd64 -t data-in-pipeline-lambda-builder .
    echo "ğŸ“¦ Extracting built package..."
    docker create --name data-in-pipeline-lambda-extract data-in-pipeline-lambda-builder
    docker cp data-in-pipeline-lambda-extract:/build/. .lambda_build/
    docker rm data-in-pipeline-lambda-extract
    echo "âœ… Lambda package built at .lambda_build/"

clean:
    echo "ğŸ§¹ Cleaning build directory..."
    rm -rf .lambda_build
