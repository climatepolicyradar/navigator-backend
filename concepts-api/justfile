# dev
# should be used for first run
bootstrap environment profile="":
    just initial-data {{environment}} {{profile}}

initial-data environment profile="":
    @echo "ðŸ”„ downloading latest data from s3"
    {{ if profile != "" { "AWS_PROFILE=" + profile } else { "" } }} aws s3 sync s3://cpr-{{environment}}-document-cache/concepts initial-data
    # ENV is used in create_duckdb to calculate which classifier_spec file to use
    ENV={{environment}} uv run python create_duckdb.py

dev:
    uv sync
    just initial-data production
    docker compose up

# Run if you've changed the dependencies.
dev-rebuild:
    just initial-data production
    docker compose up --build

prebuild environment:
    uv sync --group prebuild
    just initial-data {{environment}}
